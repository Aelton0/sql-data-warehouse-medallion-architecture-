/*LIMPANDO O BRONZE PARA O SILVER*/
#Checando valores nulos e/ou duplicados na PK
SELECT cst_id, COUNT(*)
FROM datawarehouse.bronze_crm_cust_info
GROUP BY cst_id
HAVING COUNT(*) > 1 OR cst_id IS NULL;

SELECT * FROM (
SELECT *,
ROW_NUMBER() OVER (PARTITION BY cst_id ORDER BY cst_create_data DESC) AS last_report
FROM datawarehouse.bronze_crm_cust_info) AS derived
WHERE last_report = 1;
#Checar espa√ßos nos VARCHAR e CHAR
SELECT cst_key FROM datawarehouse.bronze_crm_cust_info
WHERE cst_key != TRIM(cst_key);
/*RESULT 0*/
SELECT cst_firstname FROM datawarehouse.bronze_crm_cust_info
WHERE cst_firstname != TRIM(cst_firstname);
/*RESULT 17*/
SELECT cst_lastname FROM datawarehouse.bronze_crm_cust_info
WHERE cst_lastname != TRIM(cst_lastname);
/*RESULT 22*/



SELECT * FROM datawarehouse.bronze_crm_prd_info;

SELECT * FROM datawarehouse.bronze_crm_sales_details;

SELECT * FROM datawarehouse.bronze_erp_cust_az12;

SELECT * FROM datawarehouse.bronze_erp_loc_a101;

SELECT * FROM datawarehouse.bronze_erp_px_cat_g1v2;

